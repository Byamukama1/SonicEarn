<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Success Pay Investments</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <style>
    :root{
      /* Brand colors (from your signup page) */
      --navy-900:#0b1220;
      --navy-800:#111827;
      --ink:#0b1324;
      --muted:#64748b;
      --card:#ffffff;
      --border:#e5e7eb;
      --accent:#f59e0b;   /* amber */
      --accent2:#d97706;  /* deep amber */

      --shadow:0 16px 40px rgba(2,6,23,.08);
      --navH:64px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:linear-gradient(160deg,var(--navy-900) 0%, #101a2f 60%, var(--navy-800) 100%);
      font-family: system-ui,-apple-system,"Segoe UI",Roboto,Arial,"Noto Sans",sans-serif;
      color:var(--ink);
    }
    .app{
      min-height:100svh;
      display:flex; flex-direction:column;
      padding-bottom:calc(var(--navH) + env(safe-area-inset-bottom,0px));
    }

    /* HEADER */
    header{
      padding:16px;
      color:#f8fafc;
      background:linear-gradient(135deg, rgba(245,158,11,.18), transparent 40%);
    }
    .brand{
      display:flex; align-items:center; gap:12px;
    }
    .brand i{
      width:44px; height:44px; border-radius:12px;
      display:flex; align-items:center; justify-content:center;
      background:rgba(245,158,11,.14); color:#f59e0b;
      border:1px solid rgba(245,158,11,.22);
    }
    .brand h1{margin:0; font-size:18px; font-weight:800; letter-spacing:.2px}
    .brand small{display:block; color:#d1d5db}

    /* CONTENT SHEET */
    .sheet{
      background:#fff; border-radius:18px 18px 0 0;
      margin-top:8px;
      padding:14px 16px 0 16px;
    }

    /* SUMMARY CARDS */
    .grid{
      display:grid; grid-template-columns:1fr 1fr; gap:12px;
    }
    .card{
      background:var(--card); border:1px solid var(--border);
      border-radius:16px; box-shadow:var(--shadow);
      padding:14px;
    }
    .label{font-size:12px;color:var(--muted);margin-bottom:6px}
    .value{font-size:18px;font-weight:800}
    .mono{font-feature-settings:"tnum" 1,"lnum" 1}

    /* ACTION BUTTONS under summary */
    .actions{
      display:grid; grid-template-columns:1fr 1fr; gap:12px; margin:14px 0 6px;
    }
    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      padding:14px 12px; border:none; border-radius:14px;
      color:#111827; font-weight:800; letter-spacing:.2px; cursor:pointer;
      background:linear-gradient(180deg,var(--accent) 0%, var(--accent2) 100%);
      box-shadow:0 12px 26px rgba(217,119,6,.28);
      text-decoration:none;
    }
    .btn i{color:#111827}

    /* SECTION */
    .section{margin:16px 0}
    .section h2{font-size:16px;margin:0 0 10px 0}

    /* TABLE */
    .table-wrap{
      background:#fff; border:1px solid var(--border); border-radius:14px; overflow:hidden; box-shadow:var(--shadow);
    }
    table{width:100%; border-collapse:collapse; font-size:14px}
    thead{background:#f9fafb}
    th,td{padding:10px 12px; text-align:right; border-bottom:1px solid #f1f5f9}
    th:first-child,td:first-child{text-align:left}
    tbody tr:last-child td{border-bottom:none}

    /* NAV */
    nav{
      position:fixed; left:0; right:0; bottom:0; height:var(--navH);
      background:#fff; border-top:1px solid var(--border);
      display:grid; grid-template-columns:repeat(4,1fr);
      padding-bottom:env(safe-area-inset-bottom,0px);
      z-index:10;
    }
    .tab{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:4px;
      color:var(--muted);font-size:11px;text-decoration:none}
    .tab i{font-size:18px}
    .tab.active{color:#111827;font-weight:700}
    .tab.active i{color:var(--accent2)}

    /* Skeleton shimmer */
    .skeleton{background:linear-gradient(90deg,#f3f4f6 25%,#eceef2 37%,#f3f4f6 63%); background-size:400% 100%; animation:sh 1.2s infinite}
    @keyframes sh{0%{background-position:100% 0}100%{background-position:0 0}}
  </style>
</head>
<body>
  <div class="app">
    <!-- TOP BAR -->
    <header>
      <div class="brand">
        <i class="fas fa-vault"></i>
        <div>
          <h1>Success Pay Investments</h1>
          <small>Secure • Simple • Fast</small>
        </div>
      </div>
    </header>

    <!-- WHITE CONTENT SHEET -->
    <div class="sheet">
      <!-- SUMMARY -->
      <section class="grid">
        <div class="card">
          <div class="label">Account Balance (UGX)</div>
          <div id="balance" class="value mono skeleton" style="border-radius:6px;height:26px;"></div>
        </div>
        <div class="card">
          <div class="label">Total Withdrawn (UGX)</div>
          <div id="withdrawn" class="value mono skeleton" style="border-radius:6px;height:26px;"></div>
        </div>
      </section>

      <!-- ACTION BUTTONS -->
      <div class="actions">
        <a class="btn" href="deposit.html"><i class="fas fa-arrow-down"></i>Deposit</a>
        <a class="btn" href="withdraw.html"><i class="fas fa-arrow-up"></i>Withdraw</a>
      </div>

      <!-- INVESTMENT TABLE -->
      <section class="section">
        <h2>Earnings Preview (20% daily • 30 days)</h2>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>Amount (UGX)</th>
                <th>Daily (UGX)</th>
                <th>Total in 30 days (UGX)</th>
              </tr>
            </thead>
            <tbody id="invBody">
              <!-- rows injected by JS -->
            </tbody>
          </table>
        </div>
        <p style="color:var(--muted);margin:8px 2px 18px">
          Minimum <b>20,000</b>. Then +<b>50,000</b> up to <b>500,000</b>, then +<b>500,000</b> up to <b>5,000,000</b>.
        </p>
      </section>
    </div>
  </div>

  <!-- BOTTOM NAV -->
  <nav>
    <a class="tab active" href="index.html" aria-current="page">
      <i class="fas fa-home"></i><span>Home</span>
    </a>
    <a class="tab" href="investments.html">
      <i class="fas fa-chart-line"></i><span>Investments</span>
    </a>
    <a class="tab" href="referrals.html">
      <i class="fas fa-user-friends"></i><span>Refer</span>
    </a>
    <a class="tab" href="account.html">
      <i class="fas fa-user"></i><span>Account</span>
    </a>
  </nav>

  <!-- Firebase + Logic -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // SAME CONFIG (per your project)
    const firebaseConfig = {
      apiKey: "AIzaSyDqXsmhAt_jDRC3sYzSZ0mJXGLHoQYlPBc",
      authDomain: "sonicearn-a13b3.firebaseapp.com",
      projectId: "sonicearn-a13b3",
      storageBucket: "sonicearn-a13b3.firebasestorage.app",
      messagingSenderId: "538538743721",
      appId: "1:538538743721:web:3ca577a8b2a6ba43e416b8",
      measurementId: "G-XGD292PMYM"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const fmt = (n) => new Intl.NumberFormat('en-UG', { maximumFractionDigits: 0 }).format(Math.round(n));

    function buildInvestmentRows(){
      const body = document.getElementById('invBody');
      body.innerHTML = '';
      const DAILY_RATE = 0.20;
      const DAYS = 30;

      const amounts = [];
      // 20,000 first
      amounts.push(20000);
      // 70,000 → 500,000 step 50,000
      for(let a = 70000; a <= 500000; a += 50000) amounts.push(a);
      // 1,000,000 → 5,000,000 step 500,000
      for(let a = 1000000; a <= 5000000; a += 500000) amounts.push(a);

      for(const amount of amounts){
        const daily = amount * DAILY_RATE;
        const total = daily * DAYS;
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="mono">${fmt(amount)}</td>
          <td class="mono">${fmt(daily)}</td>
          <td class="mono">${fmt(total)}</td>
        `;
        body.appendChild(tr);
      }
    }

    async function loadSummary(uid){
      const ref = doc(db, 'users', uid);
      const snap = await getDoc(ref);
      const elBal = document.getElementById('balance');
      const elWit = document.getElementById('withdrawn');

      elBal.classList.remove('skeleton');
      elWit.classList.remove('skeleton');

      if(snap.exists()){
        const d = snap.data();
        elBal.textContent = fmt(d.accountBalance ?? 0);
        elWit.textContent = fmt(d.totalWithdrawn ?? 0);
      }else{
        elBal.textContent = '0';
        elWit.textContent = '0';
      }
    }

    onAuthStateChanged(auth, (user)=>{
      if(!user){
        location.href = 'login.html';
        return;
      }
      buildInvestmentRows();
      loadSummary(user.uid).catch(console.error);
    });
  </script>
</body>
</html>